var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},n={},a=t.parcelRequired7c6;null==a&&((a=function(t){if(t in e)return e[t].exports;if(t in n){var a=n[t];delete n[t];var r={id:t,exports:{}};return e[t]=r,a.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){n[t]=e},t.parcelRequired7c6=a),a("krGWQ"),a("4aPXr");var r=a("4aPXr"),i=a("krGWQ");const s=new(0,r.SStorage);(0,i.getRefs)().libraryLogo.addEventListener("click",(function(){s.clear()})),a("2lP43"),a("3tw01"),a("cgCOF"),a("hJCi4");var l=a("hqPq9"),o=a("sgMsR"),c=(i=a("krGWQ"),a("gzWlL")),d=a("fK7aK"),u=a("4AmR3");l=a("hqPq9"),o=a("sgMsR"),i=a("krGWQ"),c=a("gzWlL"),d=a("fK7aK"),u=a("4AmR3");const p=(0,i.getRefs)();function m(){p.libraryBtnW.classList.add("current-btn"),p.libraryBtnQ.classList.remove("current-btn"),o.fbFilmsAuth.isLogin&&(p.library.classList.add("min-height"),(0,c.spinnerOn)(),(0,u.emptyLibraryHide)(),p.library.innerHTML="",g(l.PLACE_W).then((({films:t})=>f(t))).then((t=>{0!==t.length&&(h(t),(0,c.spinnerOff)(),(0,d.renderMarkupList)(p.library,t,d.markupCreating)),0===t.length&&(p.library.classList.remove("min-height"),(0,c.spinnerOff)(),(0,u.emptyLibraryShow)())})))}async function g(t){if(o.fbFilmsAuth.isLogin)try{const e=await l.fbFilmsData.getFilms(t);if(e)return e}catch(t){console.log(t)}}function f(t){return t.map((({id:t,posters:e,title:n,genres:a,year:r,vote:i})=>({id:t,posters:e,title:n,genres:a,year:r,vote:i})))}function h(t){return t.forEach((t=>{1===t.genres.length&&(t.genres=[t.genres[0].name]),2===t.genres.length&&(t.genres=[t.genres[0].name,t.genres[1].name]),t.genres.length>2&&(t.genres=[t.genres[0].name,t.genres[1].name,"Other"])}))}p.libraryBtnW.addEventListener("click",m);const b=(0,i.getRefs)();function y(){b.libraryBtnW.classList.remove("current-btn"),b.libraryBtnQ.classList.add("current-btn"),o.fbFilmsAuth.isLogin&&(b.library.classList.add("min-height"),(0,c.spinnerOn)(),(0,u.emptyLibraryHide)(),b.library.innerHTML="",g(l.PLACE_Q).then((({films:t})=>f(t))).then((t=>{0!==t.length&&(h(t),(0,c.spinnerOff)(),(0,d.renderMarkupList)(b.library,t,d.markupCreating)),0===t.length&&(b.library.classList.remove("min-height"),(0,c.spinnerOff)(),(0,u.emptyLibraryShow)())})))}b.libraryBtnQ.addEventListener("click",y),a("ihsYy");i=a("krGWQ");var v=a("4Dq8E");var L=a("lBdXx"),w=a("jrNhD");a("sgMsR");l=a("hqPq9");const q=new(0,a("6sNdw").default),W=(0,i.getRefs)(),E=new(0,v.default);let k=null,F=null;!function(){async function t(t){if(t.target.classList.contains("remove-from-watched")){await l.fbFilmsData.removeFilm(F,"WA");(0,w.addMod)(t.target,"watched"),m()}else if(t.target.classList.contains("add-to-watched")){const e=await E.getById(F),n=await l.fbFilmsData.writeTo(e,"WA");"WA"!==n?.place&&"WA"!==n?.place2||(0,w.removeMod)(t.target,"watched"),m()}}async function e(t){if(t.target.classList.contains("remove-from-queue")){await l.fbFilmsData.removeFilm(F,"QU");(0,w.addMod)(t.target,"queue"),y()}else if(t.target.classList.contains("add-to-queue")){const e=await E.getById(F),n=await l.fbFilmsData.writeTo(e,"QU");"QU"===n?.place||n?.place2,(0,w.removeMod)(t.target,"queue"),y()}}function n(t){i()}function a(t){"Escape"===t.key&&(i(),document.removeEventListener("keydown",a))}function r(t){t.target===t.currentTarget&&(i(),W.modal.removeEventListener("click",r))}function i(){document.body.classList.toggle("modal-open"),W.modal.classList.toggle("is_hidden")}function s(t){q.filmID=F,q.showTrailer(),n()}W.library.addEventListener("click",(function(n){const o=n.target.hasAttribute("data-id");if(F=n.target.dataset.id,n.target===n.currentTarget)return;if(!1===o)return;W.modalFilmWrapper.innerHTML="",document.addEventListener("keydown",a),W.modal.addEventListener("click",r),i(),E.getById(F).then((n=>{var a,r;k=n,a=W.modalFilmWrapper,r=function({title:t,vote:e,votes:n,popularity:a,original_title:r,genres:i,about:s,poster_path:l,posters:o,year:c}){const d=i.map((t=>t.name)).join(", ");return`<div class="modal-container">\n        <div class="poster-thumb">\n          <picture>\n              <source\n              srcset="\n              ${o[4].path} 1x,\n              ${o[5].path} 2x\n              "\n              media="(min-width: 1200px)"\n            />\n              <source\n              srcset="\n              ${o[3].path} 1x,\n              ${o[4].path} 2x\n              "\n              media="(min-width: 768px)"\n            />\n              <source\n              srcset="\n              ${o[3].path} 1x,\n              ${o[4].path} 2x\n              "\n              media="(max-width: 767px)"\n            />\n  \n            <img\n              class="movie-poster"\n              src="${o[3].path}"\n              alt="${t}"\n  \n              loading="lazy"\n            />\n          </picture>\n          <div class="trailer-overlay">\n          <button type="button" class="trailer-play-btn">\n          &#9655;\n              </button>\n          \n          </div>\n        </div>\n  \n        <div>\n          <table class="info">\n            <caption class="movie-title">\n            ${t.toUpperCase()}\n            </caption>\n            <tbody>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Vote / Votes</p>\n                </td>\n                <td class="description">\n                  <span class="vote">${e} </span> &nbsp;\n                  <span class="characteristic">/</span> ${n}\n                </td>\n              </tr>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Popularity</p>\n                </td>\n                <td class="description">${a}</td>\n              </tr>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Original Title</p>\n                </td>\n                <td class="description">${r.toUpperCase()}</td>\n              </tr>\n              <tr class="table-row">\n                <td class="td">\n                  <p class="characteristic">Genre</p>\n                </td>\n                <td class="description">${d}</td>\n              </tr>\n            </tbody>\n          </table>\n          <h3 class="about">About</h3>\n          <p class="about-descr">\n            ${s}\n          </p>\n          <div class="buttons-wrapper">\n            <button\n              type="button"\n              class="button-modal add-to-watched"\n              data-action="add-to-watched"\n            >\n            add to watched</button\n            ><button\n              type="button"\n              class="button-modal add-to-queue"\n              data-action="add-to-queue"\n            >\n            add to queue\n            </button>\n          </div>\n        </div>\n      </div>\n      `}(n),a.insertAdjacentHTML("beforeend",r);const i=W.modalFilmWrapper.querySelector(".add-to-watched"),o=W.modalFilmWrapper.querySelector(".add-to-queue");return W.modalFilmWrapper.querySelector(".trailer-play-btn").addEventListener("click",s),i.addEventListener("click",t),o.addEventListener("click",e),l.fbFilmsData.getFilmById(F)})).then((t=>{const e=W.modalFilmWrapper.querySelector(".add-to-watched"),n=W.modalFilmWrapper.querySelector(".add-to-queue");t&&t?.id&&(t?.place!=l.PLACE_W&&t?.place2!=l.PLACE_W||(0,w.removeMod)(e,"watched"),t?.place!=l.PLACE_Q&&t?.place2!=l.PLACE_Q||(0,w.removeMod)(n,"queue"))})).catch(L.default)})),W.closeModalBtn.addEventListener("click",n)}();
//# sourceMappingURL=library.499c614d.js.map
